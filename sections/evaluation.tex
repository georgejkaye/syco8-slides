\section{Evaluating digital circuits}

\begin{frame}
    \frametitle{Productivity}

    For \alert{closed circuits} the aim is to reduce to a (\alert{possibly infinite}) sequence of values.        

    \pause

    \begin{center}
        \tikzfig{circuits/productivity/step-0}
        \quad\(=\)\quad
        \scalebox{0.5}{\tikzfig{streams/streamcirc-simple}}
    \end{center}


    \pause

    Circuits that do this are called \alert{productive}.

\end{frame}

\begin{frame}
    \frametitle{Delay-guarded feedback}

    Some circuits have \alert{delay-guarded feedback}.

    \pause

    \begin{center}
        \tikzfig{circuits/productivity/step-0}
        \quad\(=\)\quad
        \tikzfig{circuits/productivity/delay-guarded}
    \end{center}

    where \(\hat{F}\) is combinational.

    \pause

    \vspace{1em}

    \begin{theorem}[Ghica, Jung and Lopez, 2017]
        Circuits with delay-guarded feedback are productive.
    \end{theorem}

\end{frame}

\begin{frame}
    \frametitle{Cyclic combinational circuits}

    But not all non-delay-guarded circuits are unproductive!
    
    \pause

    \begin{center}
        \tikzfig{circuits/examples/cyclic-combinational}
        \pause
        \quad\(=\)\quad
        \tikzfig{circuits/examples/cyclic-combinational-reduced}
    \end{center}

    \pause

    These are called \alert{cyclic combinational circuits}.

\end{frame}

\begin{frame}
    \frametitle{Unproductive circuits}

    However some non-delay-guarded circuits \alert{are} unproductive...

    \begin{center}
        \pause
        \tikzfig{circuits/productivity/trand}
        \pause
        \quad\(=\)\quad
        \tikzfig{circuits/productivity/trand-unfold}

    \end{center}

\end{frame}

\begin{frame}
    \frametitle{Unproductive circuits -- what to do?}

    Ban non-delay-guarded circuits?

    \pause

    This would mean we can't model cyclic combinational circuits.

    \pause

    Also implies we are working in a category with \alert{delayed trace}.
    
    \pause

    We would lose the \alert{unfolding} rule.

\end{frame}

\begin{frame}
    \frametitle{Eliminating `instant' feedback}

    \pause

    Our gates are \alert{monotonic}, so they must have a \alert{least fixed point}...
    
    \[f^i(\bot) = f^{i+1}(\bot)\]

    \pause

    Because the value set \(\values\) is finite, we can always find this fixpoint!    
    
\end{frame}

\begin{frame}
    \frametitle{Eliminating `instant' feedback}

    
    \begin{center}
        \tikzfig{circuits/productivity/trand} 
        \pause
        \quad\(=\)\quad
        \tikzfig{circuits/productivity/trand-instfb}

        \vspace{1em}

        \pause
        \quad\(=\)\quad
        \tikzfig{circuits/productivity/trand-instfb-reduced-1}
        \pause
        \quad\(=\)\quad
        \tikzfig{circuits/productivity/trand-instfb-reduced-2}
        \pause
        \quad\(=\)\quad
        \tikzfig{circuits/productivity/trand-instfb-reduced-3}
    \end{center}


\end{frame}

\begin{frame}
    \frametitle{Productivity, redux}

    \begin{theorem}
        For any circuit \(\,\tikzfig{circuits/components/fcirc-closed}\,\), there exists values \(\,\tikzfig{circuits/components/values}\,\) and circuit \(\,\tikzfig{circuits/components/gcirc-closed}\,\) such that 

        \pause

        \begin{center}
            \tikzfig{circuits/components/fcirc-closed} 
            \quad\(=\)\quad
            \tikzfig{circuits/productivity/productive} 
        \end{center}
    \end{theorem}

    \pause
    \alert{All} circuits are productive!

\end{frame}


\begin{frame}
    \frametitle{Is this all correct?}

    We have \alert{extended} the existing axiomatisation of digital circuits to work with \alert{instant feedback}.

    \pause

    But is it correct?

    \pause

    We must compare with the \alert{denotational semantics}.
    
\end{frame}

\begin{frame}
    \frametitle{The denotational semantics of circuits}

    Circuits \(m \to n\) \(\Rightarrow\) functions \((\valuetuple{m})^\omega \to (\valuetuple{n})^\omega\). 

    \pause

    How do we translate a circuit into a stream?

    \pause

    We will take a route via \alert{Mealy machines}.

\end{frame}