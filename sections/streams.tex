\section{Streams}

\begin{frame}
    \frametitle{The final Mealy coalgebra}

    \pause

    A Mealy machine is a \alert{coalgebra} of the functor \(R(S) = (S \times N)^M\) in \textbf{Set}.

    \pause

    This means there is the notion of a \alert{final coalgebra}...

\end{frame}

\begin{frame}
    \frametitle{The final Mealy coalgebra}

    \pause

    \begin{center}
        \includestandalone[scale=1]{tikz/streams/finalhom-simple}
    \end{center}

    \pause

    We compute the \alert{unique map} \(\morph{h}{S}{(M^\omega \to N^\omega)}\) as \(O :: O \circ T :: O \circ T^2 :: \cdots\)

    \pause

    The resulting stream is the \alert{outputs over time} given an \alert{input stream}.
\end{frame}

\begin{frame}
    \frametitle{Periodic streams}

    For now, we focus on \alert{closed} circuits.

    \pause

    Our circuits are \alert{finite} in nature.

    \pause

    They may produce an infinite sequence of outputs, but it will be \alert{periodic}.

    \pause

    A stream \(\sigma\) is \alert{periodic} if it has a finite \alert{prefix} and an infinitely reoccurring \alert{period}.
    %
    \[ \textbf{v}_0 :: \textbf{v}_1 :: \cdots :: \textbf{v}_{p-1} :: \textbf{v}_{p} :: \textbf{v}_{p+1} :: \cdots \textbf{v}_{p+r-1} :: \textbf{v}_{p} :: \textbf{v}_{p+1} :: \cdots\]
    

\end{frame}

\begin{frame}
    \frametitle{From periodic streams to closed circuits}

    In the \alert{closed} case, the carrier of the final coalgebra is \(N^\omega\).

    \pause

    \[ \textbf{v}_0 :: \textbf{v}_1 :: \cdots :: \textbf{v}_{p-1} :: \textbf{v}_{p} :: \textbf{v}_{p+1} :: \cdots \textbf{v}_{p+r-1} :: \textbf{v}_{p} :: \textbf{v}_{p+1} :: \cdots\]

    \pause

    \begin{center}
        \scalebox{0.65}{\tikzfig{streams/streamcirc}}
    \end{center}

\end{frame}

\begin{frame}
    \frametitle{From periodic streams to closed circuits}
        \pause

        \begin{center}
            \scalebox{1.5}{\(\scirc[\Sigma] + \text{only closed circuits} = \cscirc[\Sigma]\)}

            \pause

            \vspace{1em}

            \scalebox{1.5}{\(\text{Periodic streams over } {\textbf{V}^n} \text{ for some n} = \pcsprop[\textbf{V}]\)}
        \end{center}
    
        \vspace{1em}

        \pause

        \begin{theorem}
            \(\cscirc[\Sigma] \cong {\pcsprop}_{\textbf{V}}\).
        \end{theorem}
\end{frame}

\begin{frame}
    \frametitle{Normalisation by evaluation}

    \pause

    We can translate a closed circuit morphism into a Mealy machine, then into a periodic stream and back to a circuit.

    \pause

    The resulting circuit will be a \alert{waveform} of values.
    
    \pause

    This is a form of \alert{normalisation by evaluation}.

\end{frame}